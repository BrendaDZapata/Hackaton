<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BachApp</title>
    <link rel="shortcut icon" href="BachApp.ico" type="image/x-icon">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/map.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
</head>
<body onload="mapLoad()">
    <section class="container map">
        <h1 class="map__title">CONSULTAR MAPA</h1>
        <div id="mapid" class="map__area"></div>
    </section>
    <script>
        function findMe() {
            var latitude = 100;
            var longitude = 100;
            var output = document.getElementById('map');

            if (navigator.geolocation) {

            } else {
                output.innerHTML = "<p>Tu navegador no soporta Geolocalizacion</p>";
            }


            //Obtenemos latitud y longitud
            function localizacion(posicion) {


                latitude = posicion.coords.latitude;
                longitude = posicion.coords.longitude;
                var mensaje = "esta es tu casa"

                var mymap = L.map('mapid').setView([latitude, longitude], 15);

                L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
                    maxZoom: 18,
                    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' +
                        'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                    id: 'mapbox/streets-v11',
                    tileSize: 512,
                    zoomOffset: -1
                }).addTo(mymap);

                L.marker([latitude, longitude]).addTo(mymap)
                    .bindPopup(mensaje);

                var popup = L.popup();

                L.circle([latitude, longitude], 100, {
                    color: 'red',
                    fillColor: '#f03',
                    fillOpacity: 0.5
                }).addTo(mymap).bindPopup("Probable zona");
                function onMapClick(e) {
                    popup
                        .setLatLng(e.latlng)
                        .setContent("You clicked the map at " + e.latlng.toString())
                        .openOn(mymap);
                }
                mymap.on('click', onMapClick);
            }
            function error() {
                output.innerHTML = "<p>No se pudo obtener tu ubicación</p>";
            }
            navigator.geolocation.getCurrentPosition(localizacion, error);
            var f = new Date();

            document.registro.latitud.value = latitude;
            document.registro.longitud.value = longitude;
            document.registro.fecha.value = f.getFullYear() + "-" + (f.getMonth() +1) + "-" + f.getDate();
            document.registro.hora.value = f.getHours() + ":" + f.getMinutes() + ":" + f.getSeconds();
           

        }
    </script>
</body>
</html>
